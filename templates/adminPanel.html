<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link
			rel="shortcut icon"
			href="../static/favicon/{{all['favicon'][0]}}"
			type="image/x-icon"
		/>
		<link
			rel="stylesheet"
			href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
		/>
		<title>WebPersona-Admin Pannel</title>
		<style>
			* {
				margin: 0; 
				padding: 0;
				box-sizing: border-box;
				font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
			}

			body,
			html {
				height: 100%;
				width: 100%;
				background-color: #f5f5f5;
			}

			nav {
				height:50px;
				background-color: #2c3e50;
				text-align: center;
				color: white;
				display: flex;
				align-items: center;
				justify-content: center;
				box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
			}

			nav h1 {
				font-size: 1.5rem;
			}

			nav h1 i {
				margin-right: 10px;
				color: #3498db;
			}

			main {
				gap: 10px;
				padding: 5px;
				height: 100vh;
				width: 100%;
				display: flex;
			}

			#web_containers,
			#preview_container,
			#feature_list {
				background: white;
				border-radius: 8px;
				padding: 10px;
				box-shadow: 0 2px 10px #0000000d;
			}
			#web_containers{
				height: 100%;
				width: 250px;
			}
			#containers_list {
				margin-top: 2em;
				display: flex;
				flex-direction: column;
				gap: 10px;
				
			}
			#containers_list details {
				margin-bottom: 10px;
				border: 1px solid #ddd;
				border-radius: 4px;
				padding: 7px;
				transition: all 0.2s;
			}

			#containers_list details:hover {
				border-color: #3498db;
				box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
			}

			#containers_list summary {
				cursor: pointer;
				padding: 6px;
				padding-right: 0;
				background-color: #f8f9fa;
				border-radius: 4px;
				display: flex;
				justify-content: space-between;
				align-items: center;
				transition: background-color 0.2s;
			}

			#containers_list summary:hover {
				background-color: #e9ecef;
			}

			#preview_container {
				display: flex;
				flex-direction: column;
				align-items: center;
				height: 100vh;
				width: calc(100% - 520px);
				max-width: calc(100% - 520px);
				padding: 0 1px;
			}

			#preview_container h1 {
				color: #2c3e50;
				font-size: 1.8rem;
			}

			#preview_container #frameContainer {
				width: 100%;
				height: 100%;
				max-width: 100%;
				overflow: auto;
			}
			#preview_container input{
				padding: 0.3em 0.6em;
				margin: 0.4em;
				border-radius: 20px;
				border: none;
				background-color: #3498db;
				color: aliceblue;
			}

			#feature_list {
				display: flex;
				flex-direction: column;
				gap: 8px;
				width: 250px;
				height: 100%;
			}
			.features{
				form{
					display: flex;
					flex-direction: row;
					justify-content: center;
					align-items: center;
					gap: 10px;
				}
			}
			#feature_list h1,
			#web_containers h1 {
				color: #2c3e50;
				text-align: center;
				font-size: 1.5rem;
				margin-bottom: 10px;
			}

			#feature_list input {
				width: 45%;
				padding: 8px 12px;
				border: 1px solid #ddd;
				border-radius: 4px;
				font-size: 14px;
				transition: border-color 0.2s;
			}

			#feature_list input:focus {
				border-color: #3498db;
				outline: none;
			}

			#feature_list button {
				width: 45%;
				padding: 9px 12px;
				background-color: #3498db;
				color: white;
				border: none;
				cursor: pointer;
				border-radius: 20px;
				transition: background-color 0.2s;
				margin: 1em 0;
			}

			#feature_list button:hover {
				background-color: #2980b9;
			}
			#feature_list #favicons_container {
				width: 100%;
				display: flex;
				align-items: center;

				/* background-color: #3498db; */
				gap: 0.8em;

				img {
					max-height: 100%;
					width: 20px;
				}
				p {
					width: 42%;
					max-width: 40%;
					overflow: hidden;
				}
			}
			#edit_favicon {
				display: block;
				width: 50%;
				margin: 0.5em 0;
				/* background-color: antiquewhite; */

				label {
					cursor: pointer;
					color: #3498db;
					transition: color 0.2s;
					float: right;
					margin: 0 0.5em;
				}

				label:hover {
					color: #2980b9;
				}
				
				input {
					display: none;
				}
			}
			#color{
				width: 100%;
				form{
					width: 100%;
					display: flex;
					align-items: center;
					justify-content: space-between;
					h4{
						color: rgb(110, 2, 103);
						border: 1px solid #3498db;
						padding: 0.3em  0.5em;
						border-radius: 5px;
						margin: 1em 0.8em;
						text-align: center;
					}
					button{
						width: auto;
						padding: 0.7em 1.2em;
						border-radius: 15px;
						background-color: #3498db;
						color: #ddd;
					}
				}
			}
	
			#EditContent form.content_edit {
				display: flex;
				align-items: center;
				box-shadow: 0 2px 8px #00000010;
				border: 1px solid #e0e0e0;
				border-radius: 10px;
				padding: 1em 1em;
				margin-top: 1em;
				gap: 0.7em;
			}
			#EditContent input[type="checkbox"] {
				width: 22px;
				height: 22px;
				accent-color: #3498db;
				border-radius: 6px;
				border: 1.5px solid #3498db;
				margin-right: 0.5em;
				transition: box-shadow 0.2s;
				box-shadow: 0 1px 3px #00000010;
			}
			#EditContent label {
				font-size: 1.1em;
				color: #2c3e50;
				font-weight: 500;
				cursor: pointer;
				letter-spacing: 0.5px;
				transition: color 0.2s;
			}
			#EditContent input[type="checkbox"]:hover {
				box-shadow: 0 0 0 2px #3498db33;
			}
			#EditContent label:hover {
				color: #3498db;
			}
			@media(max-width: 768px){
				main{
					display: block;
				}
				#web_containers{
					width: 100%;
					height: auto;
					max-height: 20em;
					margin-bottom: 10px;
					#containers_list{
						display: flex;
						flex-direction: row;
						align-items: center;
						justify-content: space-between;
						details{
							width: 40%;
						}
					}
				}
				#preview_container{
					float: inline-start;
					width: calc(100% - 205px);
					max-width: calc(100% - 205px);
				}
				#feature_list{
					float: right;
					width: 200px;
					font-size: smaller;
					input{
						transform: scale(0.9);
					}
					button{
						transform: scale(0.9);
					}
				}
			}
			#saveEditedButton{
				background: yellowgreen;
				padding: 0.7em 1.2em;
				position: fixed;
				top: 93%;
				right: 19%;
				border-radius: 20px;
				border: none;
				color:#2c3e50;
				font-weight: bolder;
				cursor: pointer;
			}
		</style>
		<script>
			function saveBlock(fileName, blockId, divId) {
				const iframe = document.getElementById('Iframe');
				const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
				const html = iframeDoc.getElementById(divId).innerHTML;
				msg="Edition saved succesfully"
				fetch('/save-block-multi', {
					method: 'POST',
					headers: { 'Content-Type': 'application/json' },
					body: JSON.stringify({
					file: fileName,
					block: blockId,
					html: html
					})
				})
				.then(res => res.text())
				.then(msg => alert(msg));
			}
		</script>
	</head>
	<body>
		{{all['body_content_editable']}}
		{% if all['body_content_editable'] %}
		<button type="button" id="saveEditedButton"  onclick="saveBlock('{{web.previewPage}}', '{{web.previewPage}}', '{{web.previewPage}}')" >Save the edited</button>
		{% else %}
		{%endif%}
		<nav>
			<h1><i class="fas fa-home"></i>Control Panel</h1>
		</nav>
		<main>
			<div id="web_containers">
				<h1>Pages</h1>
				<div id="containers_list">
					{% for page in all['pages'] %}
					<details id="favicons_container">
						<summary>
							{{page}}
							<form
								action="/delete-change-Favicon-page"
								method="post"
								enctype="multipart/form-data"
								id="edit_favicon"
							>
							{% if page != 'home.html' %}
								<label for="del{{page}}"
									><i class="fas fa-trash-alt"></i
								></label>
								<input
									type="submit"
									id="del{{page}}"
									name="delete_page"
									value="{{page}}"
								/>
							{% else %}
							{% endif %}
								<label for="view{{page}}"><i class="fas fa-eye"></i></label>
								<input
									type="submit"
									id="view{{page}}"
									name="preview_page"
									value="{{page}}"
								/>
							</form>
						</summary>
					</details>
					{% endfor %} 
					{% for folder in all['folderDict'].keys() %}
					<details>
						<summary>{{folder}}</summary>
						{% for page in all['folderDict'][folder] %}
						<details
							style="
								width: 90%;
								float:inline-end;
								border: none;
								margin: 0;
								padding: 0.5;
							"
						>
							<summary>
								{{page}}
								<form
									action="/delete-change-Favicon-page"
									method="post"
									enctype="multipart/form-data"
									id="edit_favicon"
								>
									<label for="view{{page}}"><i class="fas fa-eye"></i></label>
									<input
										type="submit"
										id="view{{page}}"
										name="preview_page"
										value="{{page}}"
									/>
								</form>
							</summary>
						</details>
						{% endfor %}
					</details>
					{% endfor %}
				</div>
			</div>
			<div id="preview_container">
				<h1>Your Website</h1>
				<form
					action="/frameSizeChange"
					method="post"
					enctype="multipart/form-data"
				>	
					{% for size in all['sizes'] %}
					<input type="submit" value="{{ size }}" name="frame_size">
					{% endfor %}
					
					<input type="number" name="frame_size" id="new_frame_size" style="background: #2c3e5020; width: 50px;" placeholder="912" />
					<button type="submit"><i class="fas fa-add"></i></button >
				</form>
				<div id="frameContainer">
					<iframe
						src="{{ all['previewPage']}}"
						width="{{ all['size'] }}"
						height="100%"
						style="display: block; margin: auto; border: none;"
						id="Iframe"
					></iframe>
				</div>
			</div>
			<div id="feature_list">
				<h1>Features</h1>
				<div class="features">
					<h3>Add New page</h3>
					<form
						action="/pageAddition"
						method="post"
						enctype="multipart/form-data"
						style="margin-top: 1em"
					>
						<input
							type="text"
							name="fileName"
							id="filName"
							placeholder="Eg.  About, New etc."
						/>
						<button type="submit">Add</button>
					</form>
				</div>
				<div class="features">
					<h3>Add Favicon/Logo</h3>
					<div style="max-height: 8em;overflow: auto;">
						{% for icon in all['favicons'] %}
						<div id="favicons_container">
							<img src="../static/favicons/{{icon}}" alt="icon" />
							<p>{{icon}}</p>
							<form
								action="/delete-change-Favicon-page"
								method="post"
								enctype="multipart/form-data"
								id="edit_favicon"
							>
								<label for="del{{icon}}"
									><i class="fas fa-trash-alt"></i
								></label>
								<input
									type="submit"
									id="del{{icon}}"
									name="delete_favicon"
									value="{{icon}}"
								/>
								<label for="ch{{icon}}"
									><i class="fas fa-plus-circle"></i
								></label>
								<input
									type="submit"
									id="ch{{icon}}"
									name="change_favicon"
									value="{{icon}}"
								/>
								<label for="logo{{icon}}"><i class="fas fa-plus"></i></label>
								<input
									type="submit"
									id="logo{{icon}}"
									name="change_logo"
									value="{{icon}}"
								/>
							</form>
						</div>
						{% endfor %}
					</div>
					<form
						action="/faviconAddition"
						method="post"
						enctype="multipart/form-data"
					>
						<input type="file" name="icon_path" id="Favicon" accept="image/*" />

						<button type="submit">Add</button>
					</form>
				</div>
				<div class="features" id="color">
					<h3>Choose Color</h3>
					<form action="/theme-rotate" method="post" enctype="multipart/form-data">
						<button type="submit" name="change_theme" value="left" class="theme-btn">
							<i class="fa fa-angle-left"></i>
						</button>

						<h4>{{ all['themes'][-15:][0].removesuffix('*/\n').removeprefix('/*') }}</h4>

						<button type="submit" name="change_theme" value="right" class="theme-btn">
							<i class="fas fa-angle-right"></i>
						</button>
					</form>
				</div>
				<div  class ="features" id="EditContent">
					<h3>Make Content Editable</h3>
					<form action="/Content-editable" method="post" enctype="multipart/form-data" class="content_edit">
						{% if all['body_content_editable']==False %}
						<input type="checkbox" name="contentEditable" id="Content_editable" onchange="this.form.submit()" />
						{% else %}
						<input type="checkbox" name="contentEditable" id="Content_editable" onchange="this.form.submit()" checked/>
						{% endif %}
						<label for="Content_editable">Content Editable</label>
					</form>
					{% if all['body_content_editable'] %} 
					<span style="font-size: xx-small; float: inline-end; color:rgba(255, 0, 0, 0.71)"><i class="fas fa-info-circle"></i> Off Before Leaving!</span>
					{% else %} {% endif %}

				</div>
			</div>
		</main>
	</body>
</html>